<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Euclidean Rhythms</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>

    <div class="container mt-3 mt-md-5">
        <h1 class="h1 mb-4">Euclidean Rhythm Pattern Generator</h1>

        <div class="row mt-3">
            <p class="col-md-8">
                This tool creates <a href="https://en.wikipedia.org/wiki/Euclidean_rhythm">Euclidean rhythm</a> patterns based on three parameters: <em>steps</em>, <em>beats</em>, and <em>offset</em>. The Euclidean algorithm distributes a chosen number of beats as evenly as possible across a fixed number of steps, producing many well-known rhythmic structures found in world music.
            </p>
            <p class="col-md-8">
                Use the steps slider to set the total length of the pattern, and the beats slider to choose how many pulses it contains. The generated pattern is displayed as a row of rectangles—colored ones represent beats. The offset slider rotates the pattern without recalculating it, letting you shift the rhythm forward or backward.
            </p>
            <p class="col-md-8">
                This tool is only a pattern generator: it doesn’t play sounds or send MIDI. You can use the visual output to program rhythms into your hardware or software sequencers.
            </p>
        </div>

        <div id="app">
            <form class="mt-3 mt-md-5">
                <div class="row">
                    <div class="col-md-4">
                        <label>Steps: <strong>{{ steps }}</strong></label>
                        <input v-model="steps" type="range" class="form-range" min="1" max="16" />
                    </div>
                    <div class="col-md-4">
                        <label>Beats: <strong>{{ beats }}</strong></label>
                        <input v-model="beats" type="range" class="form-range" min="0" max="16" />
                    </div>
                    <div class="col-md-4">
                        <label>Offset: <strong>{{ offset }}</strong></label>
                        <input v-model="offset" type="range" class="form-range" min="0" max="15" />
                    </div>
                </div>
            </form>

            <div class="row sequencer my-5 px-4">
                <div v-for="(value, index) in pattern"
                     :key="index"
                     class="step p-0 text-center"
                     :class="value === 1 ? 'step-on' : 'step-off'">{{ index + 1 }}</div>
            </div>
        </div>
    </div>

    <script type="module">
        import { createApp, ref, watch } from 'https://unpkg.com/vue@3/dist/vue.esm-browser.js'
        import { bresenhamEuclidean, rotatePattern } from './euclidean.js';

        createApp({
            setup() {
                const steps    = ref(16)
                const beats    = ref(4)
                const offset   = ref(0)
                const original = ref([])
                const pattern  = ref([])

                watch([steps, beats], () => {
                    original.value = bresenhamEuclidean(beats.value, steps.value)
                }, { immediate: true })

                watch([offset, original], () => {
                    pattern.value = rotatePattern(original.value, offset.value)
                }, { immediate: true })

                return {
                    steps, beats, offset, pattern
                }
            }
        }).mount('#app')
    </script>

</body>
</html>
